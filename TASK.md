# Task: Build llm-agent-dock Matrix Builder

## Context
This repository shall host the **llm-agent-dock** build system: a multi-arch Docker image framework that combines several “fat” public base images with modular layers for different agentic developer tools.

Codex must generate the necessary structure, plan, subtasks, and commits to reach a working prototype.

---

## Base Images (extendable list)
1. `ghcr.io/catthehacker/ubuntu:act-latest`
2. `ghcr.io/devcontainers/images/universal:2-linux`
3. `ubuntu:24.04`

Each base image represents a different ecosystem environment and must be easily swapped or extended.

---

## Agent Tools (extendable list)
1. `cline`
2. `codex`
3. `factory.ai droid`

Each tool should build as a thin layer extending one of the base images. Codex must make this structure open for new tools to be added via a single configuration.

---

## Objectives
- Design a **matrix** that produces all combinations of base images × agent tools for `amd64` and `arm64`.
- Implement **multi-arch builds**, automatic tagging, and pushing to a configurable registry.
- Include **tests** to verify builds succeed, containers run, and expected commands exist.
- Provide **documentation** explaining structure, usage, and extension.
- Organize the plan and subtasks following the conventions shown in other projects (see README.md example).
- Use separate commits for each completed subtask, following the `[codex][subtask-name]: summary` convention.

---

## Expected Artifacts
1. `Dockerfile` — parameterized using build arguments `BASE_IMAGE` and `TOOL`.
2. `docker-bake.hcl` — defines the matrix, variables, and outputs.
3. `scripts/` — helper scripts for local builds and tests.
4. `doc/ai/plan/` — structured subtask documentation generated by Codex.
5. `README.md` — short intro and usage guide.
6. `tests/` — validation routines for built images.

---

## Initial Action
Codex must:
1. Create a detailed execution plan under `doc/ai/plan/README.md`.
2. Split the work into subtasks (planning, Docker setup, matrix build, documentation, tests).
3. Execute and commit progress for each subtask individually.
4. Ensure all generated content is clear, reproducible, and documented.

---

## Notes
- Do **not** implement all builds immediately; start with a dry-run plan and structure.
- Include comments in files explaining extension points for future base images and tools.
- Keep human-readable markdown and generated automation files synchronized.
